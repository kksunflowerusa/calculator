<!DOCTYPE html>
<html lang="zh-Hant">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>KK Sunflower 國際物流集運到貨查詢</title>
<style>
  body {
    font-family: Arial, sans-serif;
    background: #f0f2f5;
    margin: 0;
    padding: 20px 0;
  }
  .container {
    background: #fff;
    padding: 40px 30px;
    border-radius: 12px;
    box-shadow: 0 4px 12px rgba(0,0,0,0.1);
    text-align: center;
    width: 90%;
    max-width: 400px;
    margin: 0 auto;
  }
  h2 {
    margin: 0 0 16px 0;
    font-size: 20px;
  }
  select, input[type="text"], button {
    width: 100%;
    padding: 12px;
    margin-bottom: 12px;
    font-size: 16px;
    border-radius: 6px;
    border: 1px solid #ccc;
    box-sizing: border-box;
  }
  button {
    border: none;
    background: #4CAF50;
    color: #fff;
    cursor: pointer;
  }
  button:hover {
    background: #45a049;
  }
  #description {
    font-size: 14px;
    color: #555;
    margin-top: 12px;
  }
  #result {
    margin-top: 20px;
    padding: 12px;
    background: #f4f4f4;
    border-radius: 6px;
    font-weight: bold;
    white-space: pre-line;
  }
  .logo {
    display: block;
    margin: 0 auto 20px;
    width: 200px;
    height: 200px;
    object-fit: contain;
  }
</style>
</head>
<body>
<div class="container">

  <img src="https://kksunflowerusa.github.io/logo/KK%20logo.png"
       alt="物流圖片"
       class="logo">

  <h2>KK Sunflower 國際物流<br>集運到貨查詢</h2>

  <select id="source">
    <option value="">--請選擇資料來源--</option>
    <option value="B3">B3</option>
    <option value="C2">C2</option>
    <option value="C2-DE">C2-DE</option>
  </select>

  <input id="order" type="text" placeholder="請輸入訂單號" />
  <button id="btn">查詢</button>

  <div id="description">請先選擇資料來源，再輸入訂單號並按「查詢」</div>
  <div id="result"></div>

</div>

<script>
const SCRIPT_URL = 'https://script.google.com/macros/s/AKfycbwtOLTAfDgSmjjddoVJGxmmk0_pBJL38OkiEfv4rFZDKL2d8VuNyAuK87s-5Tia7xLS/exec';

const sourceEl = document.getElementById('source');
const inputEl = document.getElementById('order');
const btnEl = document.getElementById('btn');
const resultEl = document.getElementById('result');
const descEl = document.getElementById('description');

function checkOrder() {
  const order = inputEl.value.trim();
  const source = sourceEl.value;

  if (!source || !order) {
    resultEl.textContent = '';
    descEl.textContent = '請選擇資料來源並輸入訂單號';
    return;
  }

  descEl.textContent = '';
  resultEl.textContent = '查詢中…';

  fetch(`${SCRIPT_URL}?source=${encodeURIComponent(source)}&order=${encodeURIComponent(order)}`)
    .then(r => r.json())  // ⭐ 解析 JSON
    .then(data => {
      if (data.status === "success") {
        resultEl.textContent = data.content;
      } else {
        resultEl.textContent = data.message || "查詢失敗";
      }
    })
    .catch(err => {
      console.error(err);
      resultEl.textContent = '查詢失敗，請稍後再試';
    });
}

btnEl.addEventListener('click', checkOrder);
inputEl.addEventListener('keyup', e => { if (e.key === 'Enter') checkOrder(); });
</script>
</body>
</html>

